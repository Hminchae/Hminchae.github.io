---
title: Swiftμ—μ„μ Type Inference(νƒ€μ… μ¶”λ΅ )μ μ‘λ™ μ›λ¦¬μ™€ ν¨μ¨μ  μ‚¬μ©μ„ μ„ν• μ „λµ
date: 2024-06-21 19:33:31 +0900
author: ν™©λ―Όμ±„
categories: [CS, Swift]
tags: [swift, ios] 
comments: true
---

## νƒ€μ… μ¶”λ΅ κ³Ό νƒ€μ… μ–΄λ…Έν…μ΄μ…
### 1. νƒ€μ… μ¶”λ΅ (Type Inference)

> μ»΄νμΌλ¬κ°€ μ£Όλ³€ μ»¨ν…μ¤νΈμ—μ„ μ„Έλ¶€ μ •λ³΄λ¥Ό νμ•…ν•  μ μμ„ λ• μ½”λ“μ—μ„ λ…μ‹μ  νƒ€μ… μ •λ³΄λ¥Ό μƒλµν•  μ μμ

```swift
let name = "molu"
```
- μ‘λ™ κ³Όμ •
  - 1λ‹¨κ³„ : μ–΄νλ¶„μ„(Lexical analysis)
  
   μ»΄νμΌλ¬λ” μ…λ ¥ νμΌ λ°”μ΄νΈλ¥Ό μ«μ λ° λ¬Έμμ—΄κ³Ό κ°™μ€ λ‹¨μ„λ΅ λ¶„ν• , κ³µλ°±κ³Ό μ£Όμ„μ„ λ²„λ¦¬λ” μ–΄ν λ¶„μ„μ„ μν–‰ν•¨. μλ¥Ό λ“¤μ–΄ μ„ μμ λ¥Ό `let`, `name`, `=`, `"`, `molu`, `"`λ΅ λ¶„ν• ν•¨

  - 2λ‹¨κ³„ : κµ¬λ¬Έ λ¶„μ„(Syntax analysis)
  
   μ»΄νμΌλ¬λ” swift λ¬Έλ²•μ— κΈ°μ΄ν• abstract syntax tree λ¥Ό μƒμ„±ν•¨
   κ΄€λ ¨ν•μ—¬ μλ£λ” [μ—¬κΈ°](https://quickbirdstudios.com/blog/abstract-syntax-tree-kotlin-swift/)λ¥Ό μ°Έκ³ 

  - 3λ‹¨κ³„ : μλ―Έλ΅ μ  λ¶„μ„(Semantic analysis) = μ»΄νμΌλ¬ κ²½κ³  λ° μ¤λ¥ λ°ν–‰ λ‹¨κ³„
  
    `molu`μ— λ€ν• μ¶”κ°€μ μΈ μ •λ³΄κ°€ μ—†κΈ° λ•λ¬Έμ— μ΄ λ‹¨κ³„μ—μ„ νƒ€μ…μ¶”λ΅ μ΄ μΌμ–΄λ‚¨. μ € ν‘ν„μ‹μ—μ„ λ³€μ μ„ μ–Έμ μ¤λ¥Έμ½μ΄ `string`μ΄λΌμ„ `string`μ΄μ–΄μ•Ό ν•¨μ„ μ¶”λ΅ ν•¨

  - κ·Έ μ΄ν›„
    
    μ»΄νμΌλ¬λ” μ¤‘κ°„ μ½”λ“λ¥Ό μƒμ„±ν• λ‹¤μ κ·Έ μ½”λ“λ¥Ό μµμ ν™”ν•κ³ , μµμΆ…μ μΌλ΅ μ–΄μ…λΈ”λ¦¬ μ½”λ“λ¥Ό μƒμ„±ν•¨. κ·Έ μ΄ν›„ μ»΄νμΌλ¬ μ™Έλ¶€μ tool chainμ€ λ§μ§€λ§‰ μ‹¤ν–‰νμΌμ„ μƒμ„±ν•λ” μ—°κ²° λ‹¨κ³„λ΅ μ΄μ–΄μ§

- μ¥μ 
  - swift μ–Έμ–΄μ κµ¬μ΅°μ  νΉμ •μ¤‘ `μ„¤κ³„μ— μν• μ•μ •μ„±`
  - μ§μ ‘ νƒ€μ…μ„ λ…μ‹ν•΄μ£Όμ§€ μ•μ•„λ„ λλ‹¤λ” κ°„νΈν•¨

- λ‹¨μ 
  -  νƒ€μ… μ¶”λ΅ μ€ μ»΄νμΌλ¬κ°€ νƒ€μ…μ„ μ¶”λ΅ ν•λ” κ³Όμ •μ—μ„ νƒ€μ… μ–΄λ…Έν…μ΄μ…λ³΄λ‹¤ μ‹κ°„μ΄ μ΅°κΈ λ” κ±Έλ¦Ό
  - μ΄κΈ°κ°’μ΄ μ—†λ” κ²½μ°, νƒ€μ…μ„ μ μ¶”ν•  μ μ—†μ–΄μ„ μ‚¬μ©ν•  μ μ—†μ
  - μ»΄νμΌλ¬κ°€ μ΄κΈ°κ°’μ„ λ³΄κ³  μ μ¶”ν•  λ•, Character/String, Double/Float λ“± μ• λ§¤ν•λ©΄ λ” ν° λ²”μ„μ μλ£ν•μΌλ΅ λƒ…λ‹¤ μ§€μ •ν•΄λ²„λ¦Ό
  
### 2. νƒ€μ… μ–΄λ…Έν…μ΄μ…(Type Annotation)
> λ³€μλ‚ μƒμλ¥Ό μ„ μ–Έν•  λ• κ·Έ νƒ€μ…μ„ λ…μ‹μ μΌλ΅ μ„ μ–Έν•΄ μ¤μΌλ΅μ¨ μ–΄λ–¤ νƒ€μ…μ κ°’μ΄ μ €μ¥λ  κ²ƒμΈμ§€λ¥Ό μ»΄νμΌλ¬μ— μ§μ ‘ μ•λ ¤μ£Όλ” λ¬Έλ²•

```swift
let name: String
```

- μ¥μ 
  - μ»΄νμΌ μ‹κ°„?
  - νƒ€μ… μ¶”λ΅ μΌλ΅ μ›ν•λ” μλ£ν•μ„ μ–»μ§€ λ»ν•  λ• μ‚¬μ©ν•  μ μμ
  - μ΄κΈ°κ°’ μ—†μ–΄λ„ μ‚¬μ©ν•  μ μμ

## μ»΄νμΌ μ‹κ°„μ— λ€ν•μ—¬

### 1. νƒ€μ… μ–΄λ…Έν…μ΄μ…μ΄ λΉ λ¥΄λ‹¤?
 λ‘ κ°€μ§€ λ°©λ²•μ μ»΄νμΌ μ‹κ°„μ„ λΉ„κµν–μ„ λ• **νƒ€μ…λ…μ‹**κ°€ λΉ λ¥΄λ‹¤λ” [μ‹¤ν— κ²°κ³Ό](https://jeong9216.tistory.com/518)κ°€ λ‚μ™€μμ

```swift
var inference: Double = 0
for _ in 0..<10 {
    let inferenceTime = measureTime {
        for _ in 0..<100000 {
            let _ = 1
        }
    }
    inference += inferenceTime
}

var annotation: Double = 0
for _ in 0..<10 {
    let annotationTime = measureTime {
        for _ in 0..<100000 {
            let _: Int = 1
        }
    }
    annotation += annotationTime
}
```

### 2. νƒ€μ… μ¶”λ΅ μ΄ λΉ λ¥΄λ‹¤?
 μ„ μ²λΌ νƒ€μ… μ–΄λ…Έν…μ΄μ…μ΄ μ¶”λ΅ ν•λ” κ³Όμ •μ΄ μƒλµλκΈ° λ•λ¬Έμ— μ»΄νμΌ μ‹κ°„μ΄ λ” λΉ λ¥΄λ‹¤λ” κ²ƒμ΄ λ³΄ν†µμ μ΄λ΅ μ΄μ§€λ§, μ»΄νμΌλ¬μ μ„±λ¥ ν–¥μƒμΌλ΅ νƒ€μ… μ¶”λ΅ μ μ»΄νμΌ μ†λ„κ°€ λ” λΉ λ¥΄λ‹¤λ” [μ‹¤ν—κ²°κ³Ό](https://forums.swift.org/t/regarding-swift-type-inference-compile-time-performance/49748)λ„ μμ

```swift
let a = "hello, world!" // type is inferred
let b = String("hello, world!") // type is inferred from String(...) and then passed to the root (the constant b)
let c: String = .init("hello, world!") // type inference is not required
let d: String = "hello, world!" // type inference is not required
```

```swift
Benchmark #1: xcrun swiftc -typecheck a.swift
  Time (mean Β± Οƒ):     175.7 ms Β±   3.5 ms    [User: 82.9 ms, System: 81.9 ms]
  Range (min β€¦ max):   171.0 ms β€¦ 182.8 ms    16 runs

Benchmark #1: xcrun swiftc -typecheck b.swift
  Time (mean Β± Οƒ):     224.8 ms Β±   2.8 ms    [User: 131.1 ms, System: 81.7 ms]
  Range (min β€¦ max):   220.2 ms β€¦ 228.2 ms    13 runs

Benchmark #1: xcrun swiftc -typecheck c.swift
  Time (mean Β± Οƒ):     672.3 ms Β±   8.0 ms    [User: 568.3 ms, System: 93.7 ms]
  Range (min β€¦ max):   662.4 ms β€¦ 685.1 ms    10 runs

Benchmark #1: xcrun swiftc -typecheck d.swift
  Time (mean Β± Οƒ):     213.3 ms Β±   2.0 ms    [User: 119.8 ms, System: 81.6 ms]
  Range (min β€¦ max):   210.2 ms β€¦ 216.5 ms    13 runs
```

μ„μ²λΌ κ°€μ¥ μ²«λ²μ§Έ κ²½μ°(νƒ€μ…μ¶”λ΅ ) μ΄ κ°€μ¥ λΉ λ¥Έ μ»΄νμΌ μ†λ„λ¥Ό λ³΄μ„.

- νƒ€μ…μ¶”λ΅ μ€ μ»΄νμΌλ¬κ°€ νƒ€μ…μ„ μ¶”λ΅ ν•λ” κ³Όμ •μ΄ μ¶”κ°€λκΈ° λ•λ¬Έμ— μ»΄νμΌ μ‹κ°„μ΄ λμ–΄λ‚¨
- ν•μ§€λ§ νƒ€μ…μ„ λ…μ‹ν•κ² λλ©΄ μ»΄νμΌλ¬κ°€ λ…μ‹λ νƒ€μ…κ³Ό μ΄κΈ°κ°’μ„ λΉ„κµν•λ” μ‘μ—…μ΄ μ¶”κ°€λμ–΄ μ»΄νμΌ μ‹κ°„μ΄ λμ–΄λ‚  μ μμ
- μ• μ΄μ— νƒ€μ… λ…μ‹μ™€ νƒ€μ… μ¶”λ΅ μ μ†λ„ μ°¨μ΄ μμ²΄λ„ λ°€λ¦¬μ„Έμ»¨λ“ λ‹¨μ„ μ°¨μ΄λ΅ λ―Έμ„Έν•¨
- μ—…λ°μ΄νΈλ§λ‹¤ μ»΄νμΌλ¬μ μ„±λ¥μ΄ μ–΄λ–¤ μ§€ν‘μ— λ€ν•μ—¬ μ¤λ½κ°€λ½ν•λ” κ²ƒμΌλ΅ λ³΄μ„

### π¤” λ…μ‹μ  νƒ€μ… μ„ μ–Έκ³Ό νƒ€μ… μ¶”λ΅  μ¤‘ μ–΄λ κ²½μ°κ°€ λ” λ°”λμ§ν•κ°€
 μ»΄νμΌλ¬κ°€ μ—…λ°μ΄νΈ λ  λ•λ§λ‹¤ μ„±λ¥μ΄ μ¤λ½κ°€λ½ν•λ” κ²ƒμΌλ΅ λ³΄μ„.. μ• μ΄μ— λΉ„κµκ°€ λ¬΄μλ―Έν•  μ •λ„λ΅ μ°¨μ΄κ°€ λ―Έλ―Έν•κΈ° λ•λ¬Έμ— μ„±λ¥μ„ λΉ„κµν•κΈ° λ³΄λ‹¤λ” λ‹¤λ¥Έ μΈ΅λ©΄μ μ¥μ (ex. κ°€λ…μ„± λ“±)μ„ λΉ„κµν•μ—¬ μ μ¬μ μ†μ— μ‚¬μ©ν•λ” κ²ƒμ΄ ν„λ…ν•΄λ³΄μ„

### μ°Έμ΅°
- [Swift) νƒ€μ… μ¶”λ΅ (Type Inference) vs νƒ€μ… μ–΄λ…Έν…μ΄μ…(Type Annotation)](https://babbab2.tistory.com/14)
- [Swift κΈ°λ¥/νΉμ§•](https://sheep1sik.tistory.com/10)
- [How does type inference (automatic type detection) works in swift?](https://stackoverflow.com/questions/28779843/how-does-type-inference-automatic-type-detection-works-in-swift)